setwd("~/R/AcusRM")
library(XLConnect)
library(lubridate)
library(dplyr)
library(ggplot2)
rawdata<-loadWorkbook("Archivo_UCA_2010-2015.xlsx")
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA))
{
rdataUCA$Ano[i]<-ano
if (i==nrow(rdataUCA)-1)
{}
else
{
if (rdataUCA$Dia[i+1]<rdataUCA$Dia[i] && rdataUCA$Mes[i+1]<rdataUCA$Mes[i])
{
ano<-ano+1
}
}
}
View(rdataUCA)
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
View(rdataUCA)
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA$Ano[i]<-ano
if (rdataUCA$Dia[i+1] < rdataUCA$Dia[i] && rdataUCA$Mes[i+1] < rdataUCA$Mes[i])
{
ano <- ano+1
}
}
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA$Ano[i]<-ano
if (rdataUCA$Dia[i] < rdataUCA$Dia[i+1] && rdataUCA$Mes[i] < rdataUCA$Mes[i+1])
{
ano <- ano+1
}
}
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA$Ano[i]<-ano
if (rdataUCA$Dia[i] < rdataUCA$Dia[i+1] && rdataUCA$Mes[i] < rdataUCA$Mes[i+1])
{
ano <- ano+1
}
}
rdataUCA$Ano[1]<-ano
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA[i,8]<-ano
if (rdataUCA$Dia[i] < rdataUCA$Dia[i+1] && rdataUCA$Mes[i] < rdataUCA$Mes[i+1]) ano <- ano+1
}
View(rdataUCA)
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA[i,8]<-ano
if (rdataUCA[i,6] < rdataUCA[i+1,6] && rdataUCA[i,7] < rdataUCA[i+1,7]) ano <- ano+1
}
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA[i,8]<-ano
if (rdataUCA[i,6] < rdataUCA[i+1,6] && rdataUCA[i,7] > rdataUCA[i+1,7]) ano <- ano+1
}
rdataUCA[1,6]
rdataUCA[1+1,6]
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA[i,8]<-ano
if (rdataUCA[i,6] < rdataUCA[i+1,6] && rdataUCA[i,7] > rdataUCA[i+1,7]) ano <- ano+1
}
rdataUCA[1,7]
rdataUCA[1+1,7]
if (rdataUCA[1,6] < rdataUCA[1+1,6] && rdataUCA[1,7] > rdataUCA[1+1,7])
if (rdataUCA[1,6] < rdataUCA[1+1,6] && rdataUCA[1,7] > rdataUCA[1+1,7])
rdataUCA[1,6] < rdataUCA[1+1,6]
rdataUCA[1,7] > rdataUCA[1+1,7]
FALSE && FALSE
rdataUCA[1,8]<-ano
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA[i,8]<-ano
if (rdataUCA[i,6] < rdataUCA[i+1,6]) ano <- ano+1
}
nrow(rdataUCA)-1
for (i in 1:2)
{
rdataUCA[i,8]<-ano
if (rdataUCA[i,6] < rdataUCA[i+1,6]) ano <- ano+1
}
for (i in 1:10)
{
rdataUCA[i,8]<-ano
if (rdataUCA[i,6] < rdataUCA[i+1,6]) ano <- ano+1
}
for (i in 1:10)
{
rdataUCA[i,8]<-ano
if (rdataUCA[i,6] > rdataUCA[i+1,6]) ano <- ano+1
}
ano<-2010
for (i in 1:10)
{
rdataUCA[i,8]<-ano
if (rdataUCA[i,6] > rdataUCA[i+1,6]) ano <- ano+1
}
ano<-2010
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA[i,8]<-ano
if (rdataUCA[i,6] > rdataUCA[i+1,6]) ano <- ano+1
}
for (i in 1:nrow(rdataUCA)-2)
{
rdataUCA[i,8]<-ano
if (rdataUCA[i,6] > rdataUCA[i+1,6]) ano <- ano+1
}
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA[i,8] <- ano
if (rdataUCA[i,6] > rdataUCA[i+1,6]) {ano <- ano+1}
}
rdataUCA[nrow(rdataUCA)-1,6] > rdataUCA[nrow(rdataUCA)-1+1,6]
ano<-2010
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA[i,8] <- ano
if (rdataUCA[i,6] > rdataUCA[i+1,6]) {ano <- ano+1}
else {}
}
View(rdataUCA)
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
View(rdataUCA)
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA[i,8] <- ano
if (rdataUCA[i,6] > rdataUCA[i+1,6]) {ano <- ano+1}
else {}
}
is.na(rdataUCA[,6])
levels(is.na(rdataUCA[,6]))
unique(is.na(rdataUCA[,6]))
unique(is.na(rdataUCA[,7]))
unique(is.na(rdataUCA[,8]))
sqrt(-1)
ano<-2010
for (i in 1:nrow(rdataUCA)-1)
{
rdataUCA[i,8] <- ano
if (rdataUCA[i,6] > rdataUCA[i+1,6] && rdataUCA[i,7] > rdataUCA[i+1,7]) {ano <- ano+1}
else {}
}
View(rdataUCA)
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA))
{
rdataUCA[i,8] <- ano
if (i =! 1)
{
if (rdataUCA[i-1,6] > rdataUCA[i,6] && rdataUCA[i-1,7] > rdataUCA[i,7])
{ano <- ano+1}
}
}
ano<-2010
for (i in 1:nrow(rdataUCA))
{
rdataUCA[i,8] <- ano
if (i != 1)
{
if (rdataUCA[i-1,6] > rdataUCA[i,6] && rdataUCA[i-1,7] > rdataUCA[i,7])
{ano <- ano+1}
}
}
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA))
{
rdataUCA[i,8] <- ano
if (i != 1)
{
if (rdataUCA[i-1,6] > rdataUCA[i,6] && rdataUCA[i-1,7] > rdataUCA[i,7])
{ano <- ano+1}
}
}
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA))
{
if (i != 1)
{
if (rdataUCA[i-1,6] > rdataUCA[i,6] && rdataUCA[i-1,7] > rdataUCA[i,7])
{
ano <- ano+1
}
}
rdataUCA[i,8] <- ano
}
for (i in 1:nrow(rdataUCA))
{
if (i > 2)
{
if (rdataUCA[i-1,6] > rdataUCA[i,6] && rdataUCA[i-1,7] > rdataUCA[i,7] && rdataUCA[i-2,6] > rdataUCA[i,6] && rdataUCA[i-2,7] > rdataUCA[i,7])
{
ano <- ano+1
}
}
rdataUCA[i,8] <- ano
}
View(rdataUCA)
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA))
{
if (i > 2)
{
if (rdataUCA[i-1,6] > rdataUCA[i,6] && rdataUCA[i-1,7] > rdataUCA[i,7] && rdataUCA[i-2,6] > rdataUCA[i,6] && rdataUCA[i-2,7] > rdataUCA[i,7])
{
ano <- ano+1
}
}
rdataUCA[i,8] <- ano
}
View(rdataUCA)
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA))
{
if (i > 2)
{
if (rdataUCA[i-1,6] > rdataUCA[i,6] && rdataUCA[i-1,7] > rdataUCA[i,7] && rdataUCA[i-2,7] > rdataUCA[i,7])
{
ano <- ano+1
}
}
rdataUCA[i,8] <- ano
}
for (i in 1:nrow(rdataUCA)-1)
{
if (i > 2)
{
if (rdataUCA[i,6] < rdataUCA[i-1,6]  && rdataUCA[i,7] < rdataUCA[i-1,7])
{
ano <- ano+1
}
}
rdataUCA[i,8] <- ano
}
ano<-2010
for (i in 1:nrow(rdataUCA)-1)
{
if (i > 1)
{
if (rdataUCA[i,6] < rdataUCA[i-1,6]  && rdataUCA[i,7] < rdataUCA[i-1,7] && rdataUCA[i,7] == rdataUCA[i+1,7])
{
ano <- ano+1
}
}
rdataUCA[i,8] <- ano
}
View(rdataUCA)
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA)-1)
{
if (i > 1)
{
if (rdataUCA[i,6] < rdataUCA[i-1,6]  && rdataUCA[i,7] < rdataUCA[i-1,7] && rdataUCA[i,7] == rdataUCA[i+1,7])
{
ano <- ano+1
}
}
rdataUCA[i,8] <- ano
if (i==nrow(rdataUCA)) rdataUCA[i,8] <- ano
}
View(rdataUCA)
rdataUCA<-readWorksheet(rawdata,"Hoja1", header=F)
# Asignar año correcto en la fecha
rdataUCA$Fecha<-as.Date(rdataUCA[,1],"%Y-%m-%d %H:%M:%S", tz = "America/Santiago")
rdataUCA<-rdataUCA[!is.na(rdataUCA$Fecha),]
rdataUCA$Dia<-day(rdataUCA$Fecha)
rdataUCA$Mes<-month(rdataUCA$Fecha)
ano<-2010
for (i in 1:nrow(rdataUCA)-1)
{
if (i > 1)
{
if (rdataUCA[i,6] < rdataUCA[i-1,6]  && rdataUCA[i,7] < rdataUCA[i-1,7] && rdataUCA[i,7] == rdataUCA[i+1,7])
{
ano <- ano+1
}
}
rdataUCA[i,8] <- ano
if (i == nrow(rdataUCA)-1) rdataUCA[i+1,8] <- ano
}
View(rdataUCA)
LARGO_NC<-round(aggregate(Fecha ~ Ano, data = rdataUCA, FUN = length),0)
Tabla<-data.frame(ANO=LARGO_NC$Ano, DENUNCIAS = LARGO_NC$Fecha, factor=rep("AÑO", each=6))
par(mar=c(11, 30, 0, 0))
g10<-ggplot(Tabla, aes(x=ANO, y=DENUNCIAS), fill=factor(factor)) +
geom_bar(aes(fill=factor(factor)), stat="identity", col="black",
position=position_identity(), width=0.9) +
guides(fill=guide_legend(reverse=TRUE))
g10 +
theme_bw() +
scale_fill_brewer(name="") +
theme(legend.position="right", axis.text.x=element_text(vjust=0.5, size=12),
axis.text.y=element_text(vjust=0.5, size=12),
axis.title.x = element_text(face="bold", size=16, margin=margin(10,0,0,0)),
axis.title.y = element_text(face="bold", size=16, margin=margin(0,15,0,0))) +
geom_text(aes(label=DENUNCIAS), vjust=1.2, colour="black",
position=position_dodge(0.9), size=4.5, fontface="bold") +
labs(x="Years", y="Noise complaints") +
scale_x_continuous(breaks=seq(2010,2015,1)) +
scale_y_continuous(expand = c(0, 100))
LARGO_NC<-round(aggregate(Fecha ~ Ano, data = rdataUCA, FUN = length),0)
Tabla<-data.frame(ANO=LARGO_NC$Ano, DENUNCIAS = LARGO_NC$Fecha, factor=rep("AÑO", each=6))
par(mar=c(11, 30, 0, 0))
g10<-ggplot(Tabla, aes(x=ANO, y=DENUNCIAS), fill=factor(factor)) +
geom_bar(aes(fill=factor(factor)), stat="identity", col="black",
position=position_identity(), width=0.9) +
guides(fill=guide_legend(reverse=TRUE))
g10 +
theme_bw() +
scale_fill_brewer(name="") +
theme(legend.position="right", axis.text.x=element_text(vjust=0.5, size=12),
axis.text.y=element_text(vjust=0.5, size=12),
axis.title.x = element_text(face="bold", size=16, margin=margin(10,0,0,0)),
axis.title.y = element_text(face="bold", size=16, margin=margin(0,15,0,0))) +
geom_text(aes(label=DENUNCIAS), vjust=1.2, colour="black",
position=position_dodge(0.9), size=4.5, fontface="bold") +
labs(x="Years", y="Noise complaints") +
scale_x_continuous(breaks=seq(2010,2015,1)) +
scale_y_continuous(expand = c(0, 100))
colnames(rdataUCA)[8] <- "Ano"
LARGO_NC<-round(aggregate(Fecha ~ Ano, data = rdataUCA, FUN = length),0)
Tabla<-data.frame(ANO=LARGO_NC$Ano, DENUNCIAS = LARGO_NC$Fecha, factor=rep("AÑO", each=6))
par(mar=c(11, 30, 0, 0))
g10<-ggplot(Tabla, aes(x=ANO, y=DENUNCIAS), fill=factor(factor)) +
geom_bar(aes(fill=factor(factor)), stat="identity", col="black",
position=position_identity(), width=0.9) +
guides(fill=guide_legend(reverse=TRUE))
g10 +
theme_bw() +
scale_fill_brewer(name="") +
theme(legend.position="right", axis.text.x=element_text(vjust=0.5, size=12),
axis.text.y=element_text(vjust=0.5, size=12),
axis.title.x = element_text(face="bold", size=16, margin=margin(10,0,0,0)),
axis.title.y = element_text(face="bold", size=16, margin=margin(0,15,0,0))) +
geom_text(aes(label=DENUNCIAS), vjust=1.2, colour="black",
position=position_dodge(0.9), size=4.5, fontface="bold") +
labs(x="Years", y="Noise complaints") +
scale_x_continuous(breaks=seq(2010,2015,1)) +
scale_y_continuous(expand = c(0, 100))
g10<-ggplot(Tabla, aes(x=ANO, y=DENUNCIAS), fill=factor(factor)) +
geom_bar(aes(fill=factor(factor)), stat="identity", col="black",
position=position_identity(), width=0.9) +
guides(fill=guide_legend(reverse=TRUE))
g10 +
theme_bw() +
scale_fill_brewer(name="") +
#theme(legend.position="right", axis.text.x=element_text(vjust=0.5, size=12),
#     axis.text.y=element_text(vjust=0.5, size=12),
#      axis.title.x = element_text(face="bold", size=16, margin=margin(10,0,0,0)),
#      axis.title.y = element_text(face="bold", size=16, margin=margin(0,15,0,0))) +
geom_text(aes(label=DENUNCIAS), vjust=1.2, colour="black",
position=position_dodge(0.9), size=4.5, fontface="bold") +
labs(x="Años", y="Denuncias de ruido") +
scale_x_continuous(breaks=seq(2010,2015,1)) +
scale_y_continuous(expand = c(0, 100))
SUM_MESC<-round(aggregate(Fecha ~ Ano+Mes, data = rdataUCA, FUN = length),0)
MEAN_MESC<-round(aggregate(Fecha ~ Mes, data = SUM_MESC, FUN = mean),0)
#Plotting
par(mar=c(3, 4, 1, 1), mgp = c(1.8, 0.1, 0))
p20<-boxplot(Fecha~Mes, data=SUM_MESC, xlab="Months", ylab="Noise complaints",
ylim=c(0,max(SUM_MESC[,3])*1.05), xaxt="n", yaxt="n")
axis(2, las=0, cex.axis=0.7, las=2, tck=.01)
axis(1, at=1:12, cex.axis=0.8, las=0, tck=0.01)
points(MEAN_MESC[,2], col="red", pch=19)
View(SUM_MESC)
setwd("~/R/Diplomado/Taller/taller-datos")
data<-read.table("~world-cup/1930--uruguay/cup.txt")
data<-read.table("~/world-cup/1930--uruguay/cup.txt")
data<-read.table("~/R/Diplomado/Taller/world-cup/1930--uruguay/cup.txt")
data<-read.table("~/R/Diplomado/Taller/taller-datos/world-cup/1930--uruguay/cup.txt")
